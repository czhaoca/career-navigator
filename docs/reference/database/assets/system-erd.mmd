erDiagram
    PF_USERS ||--o{ PF_USER_SESSIONS : "has"
    PF_USERS ||--o{ PF_API_KEYS : "owns"
    PF_USERS ||--o{ PF_AUDIT_LOG : "generates"
    PF_AUDIT_LOG }o--|| PF_USERS : "references"
    PF_LEGAL_HOLDS }o--|| PF_AUDIT_LOG : "preserves"
    
    PF_USERS {
        RAW_16 user_id PK
        VARCHAR2_255 username UK
        VARCHAR2_255 email UK
        VARCHAR2_255 password_hash
        VARCHAR2_255 mfa_secret
        VARCHAR2_64 schema_prefix UK
        VARCHAR2_255 first_name
        VARCHAR2_255 last_name
        VARCHAR2_100 timezone
        JSON preferences
        VARCHAR2_50 account_status
        TIMESTAMP created_at
        TIMESTAMP last_login
        NUMBER_1 email_verified
        TIMESTAMP terms_accepted_at
        TIMESTAMP privacy_policy_accepted_at
        VARCHAR2_50 project_environment
    }
    
    PF_USER_SESSIONS {
        RAW_16 session_id PK
        RAW_16 user_id FK
        VARCHAR2_255 token_hash UK
        VARCHAR2_45 ip_address
        CLOB user_agent
        TIMESTAMP created_at
        TIMESTAMP expires_at
        TIMESTAMP last_activity
        NUMBER_1 is_active
        VARCHAR2_50 environment
    }
    
    PF_API_KEYS {
        RAW_16 key_id PK
        RAW_16 user_id FK
        VARCHAR2_255 key_hash
        VARCHAR2_10 key_prefix
        VARCHAR2_255 name
        JSON permissions
        NUMBER rate_limit_per_hour
        TIMESTAMP last_used
        TIMESTAMP expires_at
        TIMESTAMP created_at
        NUMBER_1 is_active
        VARCHAR2_50 environment
    }
    
    PF_AUDIT_LOG {
        RAW_16 log_id PK
        RAW_16 user_id FK
        VARCHAR2_100 action
        VARCHAR2_100 resource_type
        VARCHAR2_255 resource_id
        VARCHAR2_45 ip_address
        CLOB user_agent
        JSON request_data
        NUMBER_3 response_code
        NUMBER execution_time_ms
        TIMESTAMP timestamp
        NUMBER_1 success
        CLOB error_message
        VARCHAR2_50 environment
        VARCHAR2_100 project_name
    }
    
    PF_LEGAL_HOLDS {
        RAW_16 hold_id PK
        VARCHAR2_100 resource_type
        VARCHAR2_255 resource_id
        CLOB reason
        VARCHAR2_255 created_by
        TIMESTAMP created_at
        TIMESTAMP released_at
        VARCHAR2_255 released_by
        CLOB release_reason
        NUMBER_1 is_active
        VARCHAR2_50 environment
    }